function rcube_mail_ui(){function j(b,c){a[b]=c}function k(a){if(g||(g=window.localStorage?rcmail.local_storage_get_item("prefs.larry",{}):{}),null==g[a]){var b=rcmail.get_cookie(a);null!=b&&(g[a]=b,window.localStorage&&(rcmail.local_storage_set_item("prefs.larry",g),rcmail.set_cookie(a,b,new Date)))}return g[a]}function l(a,b){if(g[a]=b,window.localStorage)rcmail.local_storage_set_item("prefs.larry",g);else{var c=new Date;c.setYear(c.getFullYear()+1),rcmail.set_cookie(a,b,c)}}function m(){if(rcmail.addEventListener("message",p),$("#taskbar a").each(function(a,b){$(b).append('<span class="tooltip">'+$(".button-inner",this).html()+"</span>")}),$("#taskbar .minmodetoggle").click(function(a){var b=$(document.body).toggleClass("minimal").hasClass("minimal");l("minimalmode",b?1:0),$(window).resize()}),"mail"==rcmail.env.task){rcmail.addEventListener("menu-open",E).addEventListener("menu-save",F).addEventListener("responseafterlist",function(a){D(rcmail.env.threading?"thread":"list")});var a=$("#dragmessagemenu");if(a.length&&(rcmail.gui_object("dragmenu","dragmessagemenu"),b.dragmenu=a),"show"==rcmail.env.action||"preview"==rcmail.env.action)rcmail.addEventListener("enable-command",w).addEventListener("aftershow-headers",function(){q()}).addEventListener("afterhide-headers",function(){q()}),$("#previewheaderstoggle").click(function(a){return C(),!1}),$("#attachment-list > li").each(function(){$(this).append($('<a class="drop"></a>').click(function(){H(this)}))}),"1"==k("previewheaders")&&C();else if("compose"==rcmail.env.action){rcmail.addEventListener("aftersend-attachment",O).addEventListener("add-recipient",function(a){Q(a.field,!0)}).addEventListener("aftertoggle-editor",function(a){window.setTimeout(function(){u()},200),a&&a.mode&&$("select[name='editorSelector']").val(a.mode)});var c,d,f,g=["cc","bcc","replyto","followupto"];for(c=0;c<g.length;c++)d=g[c],f=$("#_"+d),f.length&&(f.on("change",{v:d},function(a){this.value&&Q(a.data.v,!0)}),""!=f.val()&&Q(d,!0));$("#composeoptionstoggle").click(function(){return $("#composeoptionstoggle").toggleClass("remove"),$("#composeoptions").toggle(),u(),l("composeoptions",$("#composeoptions").is(":visible")?"1":"0"),!1}).css("cursor","pointer"),"0"!==k("composeoptions")&&$("#composeoptionstoggle").click(),$("textarea[name='_to'], textarea[name='_cc'], textarea[name='_bcc']").change(function(a){t(this)}).change(),rcmail.addEventListener("autocomplete_insert",function(a){t(a.field)});var h=rcmail.opener();h&&"compose"==h.env.action&&$("#composeoptionstoggle",opener.document).hasClass("remove")&&$("#composeoptionstoggle").click(),new rcube_splitter({id:"composesplitterv",p1:"#composeview-left",p2:"#composeview-right",orientation:"v",relative:!0,start:248,min:170,size:12,render:u}).init()}else if("list"!=rcmail.env.action&&rcmail.env.action)"get"==rcmail.env.action&&new rcube_splitter({id:"mailpartsplitterv",p1:"#messagepartheader",p2:"#messagepartcontainer",orientation:"v",relative:!0,start:226,min:150,size:12}).init();else{var i=$("#mailpreviewframe").is(":visible");$("#mailpreviewtoggle").addClass(i?"enabled":"closed").click(function(a){return B(a),!1}),$("#maillistmode").addClass(rcmail.env.threading?"":"selected").click(function(a){return D("list"),!1}),$("#mailthreadmode").addClass(rcmail.env.threading?"selected":"").click(function(a){return D("thread"),!1}),e=new rcube_splitter({id:"mailviewsplitter",p1:"#mailview-top",p2:"#mailview-bottom",orientation:"h",relative:!0,start:310,min:150,size:12,offset:4}),i&&e.init(),rcmail.addEventListener("setquota",v).addEventListener("enable-command",w).addEventListener("afterimport-messages",O)}$("#mailview-left").length&&new rcube_splitter({id:"mailviewsplitterv",p1:"#mailview-left",p2:"#mailview-right",orientation:"v",relative:!0,start:226,min:150,size:12,callback:r,render:s}).init()}else if("settings"==rcmail.env.task)rcmail.addEventListener("init",function(){var a="#settingstabpreferences";rcmail.env.action&&(a="#settingstab"+(rcmail.env.action.indexOf("identity")>0?"identities":rcmail.env.action.replace(/\./g,""))),$(a).addClass("selected").children().first().removeAttr("onclick").click(function(){return!1})}),"folders"==rcmail.env.action?(new rcube_splitter({id:"folderviewsplitter",p1:"#folderslist",p2:"#folder-details",orientation:"v",relative:!0,start:266,min:180,size:12}).init(),new rcube_scroller("#folderslist-content","#folderslist-header","#folderslist-footer"),rcmail.addEventListener("setquota",v)):"identities"==rcmail.env.action?new rcube_splitter({id:"identviewsplitter",p1:"#identitieslist",p2:"#identity-details",orientation:"v",relative:!0,start:266,min:180,size:12}).init():"responses"==rcmail.env.action?new rcube_splitter({id:"responseviewsplitter",p1:"#identitieslist",p2:"#identity-details",orientation:"v",relative:!0,start:266,min:180,size:12}).init():"preferences"!=rcmail.env.action&&rcmail.env.action?"edit-prefs"==rcmail.env.action&&($('<a href="#toggle">&#9660;</a>').addClass("advanced-toggle").appendTo("#preferences-details fieldset.advanced legend"),$("#preferences-details fieldset.advanced legend").click(function(a){var b=$(this).hasClass("collapsed");$(".advanced-toggle",this).html(b?"&#9650;":"&#9660;");$(this).toggleClass("collapsed").closest("fieldset").children(".propform").toggle()}).addClass("collapsed")):new rcube_splitter({id:"prefviewsplitter",p1:"#sectionslist",p2:"#preferences-box",orientation:"v",relative:!0,start:266,min:180,size:12}).init();else if("addressbook"==rcmail.env.task){rcmail.addEventListener("afterupload-photo",O).addEventListener("beforepushgroup",M).addEventListener("beforepopgroup",N),""==rcmail.env.action&&(new rcube_splitter({id:"addressviewsplitterd",p1:"#addressview-left",p2:"#addressview-right",orientation:"v",relative:!0,start:226,min:150,size:12,render:s}).init(),new rcube_splitter({id:"addressviewsplitter",p1:"#addresslist",p2:"#contacts-box",orientation:"v",relative:!0,start:286,min:270,size:12}).init());var a=$("#dragcontactmenu");a.length&&(rcmail.gui_object("dragmenu","dragcontactmenu"),b.dragmenu=a)}$(".tabbed").each(function(a,b){S(b)});var j=$("body > div.minwidth");j.length&&j.css("min-width",$(".toolbar").width()+$("#quicksearchbar").width()+$("#searchfilter").width()+30),$(document.body).bind("mouseup",n).bind("keyup",function(a){if(27==a.keyCode)for(var c in b)b[c].is(":visible")&&y(c,!1)}),$("iframe").load(function(a){try{var b=this.contentDocument?this.contentDocument:this.contentWindow?this.contentWindow.document:null;$(b).mouseup(n)}catch(a){}}).contents().mouseup(n),window.onresize=o,o()}function n(a){var d,e,f=a.target;"inner"==f.className&&(f=a.target.parentNode);for(var g in b)if(e=b[g],d=c[g],e.is(":visible")&&f.id!=g+"link"&&f!=e.get(0)&&!d.toggle&&(!d.editable||!A(f,e.get(0)))&&(!d.sticky||!rcube_mouse_is_over(a,e.get(0)))&&!$(f).is(".folder-selector-link")){var h=g+"";window.setTimeout(function(){z(h,!1)},10)}}function o(a){var b=a?10:0;rcmail.resize_timeout&&window.clearTimeout(rcmail.resize_timeout),rcmail.resize_timeout=window.setTimeout(function(){"mail"==rcmail.env.task&&("show"==rcmail.env.action||"preview"==rcmail.env.action?q():"compose"==rcmail.env.action&&u()),$("body.iframe .footerleft").each(function(){var a=$(this),b=$(document.body),c=a.hasClass("floating"),d=b.outerHeight(!0)>$(window).height();if(d!=c){var e=d?"addClass":"removeClass";a[e]("floating"),b[e]("floatingbuttons")}})},b)}function p(b){var c=$(b.object).siblings("div");if(c.length&&$(b.object).insertBefore(c.first()),"error"==b.type&&"login"!=rcmail.env.task){rcmail.hide_message(b.object),d.message_timer&&window.clearTimeout(d.message_timer),d.messagedialog||(d.messagedialog=$("<div>").addClass("popupdialog").hide());var e=b.message,f=function(){d.messagedialog.is(":visible")&&d.messagedialog.dialog("destroy").hide()};d.messagedialog.is(":visible")&&(e=d.messagedialog.html()+"<p>"+b.message+"</p>"),d.messagedialog.html(e).dialog({resizable:!1,closeOnEscape:!0,dialogClass:"popupmessage "+b.type,title:a.errortitle,close:f,position:["center","center"],hide:{effect:"fadeOut"},width:420,minHeight:90}).show(),b.timeout>0&&(d.message_timer=window.setTimeout(f,b.timeout))}}function q(){$("#messagecontent").css("top",$("#messageheader").outerHeight()+1+"px"),$("#message-objects div a").addClass("button"),$("#attachment-list li").length||($("div.rightcol").hide(),$("div.leftcol").css("margin-right","0"))}function r(a){}function s(a){}function t(a){if("TEXTAREA"==a.nodeName){var b=$(a),c=14,d=a.scrollHeight,e=a.value.length>80&&d>1.5*c?2:1;b.css("height",c*e+"px"),u()}}function u(){var d,e,f,g,a=$("#composebody"),b=$("#compose-content"),c=$("#composeview-bottom"),h=0,i=300,f=b.height()-c.position().top;g=i-f,h=g>-100?0:40,b.css("overflow",g>0?"auto":"hidden"),d=a.parent().width()-5,e=a.parent().height()-16,a.width(d).height(e),$("#composebody_tbl").width(d+8+"px").height("").css("margin-top","1px"),$("#composebody_ifr").width(d+8+"px").height(e-40+"px"),$("#googie_edit_layer").height(e+"px")}function v(a){var b=24,c=20,d=a.total?Math.ceil(a.percent/100*c)*b:0;a.total&&d==b*c&&a.percent<100&&(d-=b),$("#quotadisplay").css("background-position","0 -"+d+"px")}function w(a){if("reply-list"==a.command&&1==rcmail.env.reply_all_mode){var b=rcmail.gettext(a.status?"replylist":"replyall");"preview"==rcmail.env.action?$("a.button.replyall").attr("title",b):$("a.button.reply-all").text(b).attr("title",b)}}function x(a,d){var e=b[a]=$("#"+a);e.appendTo(document.body),e.length&&(c[a]=$.extend(c[a]||{},d||{}))}function y(a,b,d){!d&&c[a]||x(a,d);var e=z(a,b),d=c[a];"function"==typeof d.callback&&d.callback(e)}function z(a,d){var e=b[a],f=c[a],g=$(f.link?f.link:"#"+a+"link");f.above;if(e||(e=b[a]=$("#"+a),e.appendTo(document.body)),!e||!e.length)return!1;if("undefined"==typeof d?d=!e.is(":visible"):f.toggle&&d&&e.is(":visible")&&(d=!1),d&&g.length){var i=$(document).width()-80,j=40;i>300&&(i=300,j=($(document).width()-i)/2),e.css({left:j,top:50,width:i,height:$(document).height()-100})}return e[d?"show":"hide"](),bw.ie6&&f.overlap&&($("select").css("visibility",d?"hidden":"inherit"),$("select",e).css("visibility","inherit")),d}function A(a,b){for(;a.parentNode;){if(a.parentNode==b)return!0;a=a.parentNode}return!1}function B(a){var i,b=$(a.target),c=$("#mailpreviewframe"),d=!c.is(":visible");e.pos||parseInt(k("mailviewsplitter")||320);c.toggle(),b.removeClass().addClass(d?"enabled":"closed"),d?($("#mailview-top").removeClass("fullheight").css({bottom:"auto"}),$("#mailview-bottom").css({height:"auto"}).show(),rcmail.env.contentframe="messagecontframe",(i=rcmail.message_list.get_single_selection())&&rcmail.show_message(i,!1,!0),e.handle?(e.handle.show(),e.resize()):e.init()):(rcmail.env.contentframe=null,rcmail.show_contentframe(!1),$("#mailview-top").addClass("fullheight").css({height:"auto",bottom:"0px"}),$("#mailview-bottom").css({top:"auto",height:"0px"}).hide(),e.handle&&e.handle.hide()),rcmail.message_list&&(d&&i&&rcmail.message_list.scrollto(i),rcmail.message_list.resize()),rcmail.command("save-pref",{name:"preview_pane",value:d?1:0})}function C(){$("#preview-shortheaders").toggle();var a=$("#preview-allheaders").toggle(),b=$("a#previewheaderstoggle");a.is(":visible")?b.attr("href","#hide").removeClass("add").addClass("remove"):b.attr("href","#details").removeClass("remove").addClass("add"),l("previewheaders",a.is(":visible")?"1":"0")}function D(a){rcmail.env.threading!=("thread"==a)&&rcmail.set_list_options(null,void 0,void 0,"thread"==a?1:0),$("#maillistmode, #mailthreadmode").removeClass("selected"),$("#mail"+a+"mode").addClass("selected")}function E(a){a&&a.props&&"attachmentmenu"==a.props.menu?z("attachmentmenu"):J()}function F(a){K()}function G(a){if(a&&rcmail.env.search_mods){var c,d,e=b.searchmenu,f=$('input:checkbox[name="s_mods[]"]',e),g=rcmail.env.mailbox,h=rcmail.env.search_mods;if("mail"==rcmail.env.task?(h=h[g]?h[g]:h["*"],d="text"):d="*",h[d])f.map(function(){this.checked=!0,this.disabled=this.value!=d});else{f.prop("disabled",!1).prop("checked",!1);for(c in h)$("#s_mod_"+c).prop("checked",!0)}}}function H(a){var b=a.parentNode.id.replace(/^attach/,"");$("#attachmenuopen").unbind("click").attr("onclick","").click(function(a){return rcmail.command("open-attachment",b,this)}),$("#attachmenudownload").unbind("click").attr("onclick","").click(function(){rcmail.command("download-attachment",b,this)}),c.attachmentmenu.link=a,rcmail.command("menu-open",{menu:"attachmentmenu",id:b})}function I(a){var c,d,e=rcmail.spellcheck_lang(),f=b.spellmenu,g=$("ul",f);if(!g.length){g=$('<ul class="toolbarmenu selectable">');for(i in rcmail.env.spell_langs)d=$("<li>"),c=$('<a href="#"></a>').text(rcmail.env.spell_langs[i]).addClass("active").data("lang",i).click(function(){rcmail.spellcheck_lang_set($(this).data("lang"))}),c.appendTo(d),d.appendTo(g);g.appendTo(f)}$("li",g).each(function(){var a=$("a",this);a.data("lang")==e?a.addClass("selected"):a.hasClass("selected")&&a.removeClass("selected")})}function J(){var a=$("#listoptions");return a.is(":visible")?void a.dialog("close"):($('input[name="sort_col"][value="'+rcmail.env.sort_col+'"]').prop("checked",!0),$('input[name="sort_ord"][value="DESC"]').prop("checked","DESC"==rcmail.env.sort_order),$('input[name="sort_ord"][value="ASC"]').prop("checked","DESC"!=rcmail.env.sort_order),$('input[name="list_col[]"]').each(function(){$(this).prop("checked",$.inArray(this.value,rcmail.env.coltypes)!=-1)}),void a.dialog({modal:!0,resizable:!1,closeOnEscape:!0,title:null,close:function(){a.dialog("destroy").hide()},minWidth:500,width:a.width()+25}).show())}function K(){$("#listoptions").dialog("close");var a=$('input[name="sort_col"]:checked').val(),b=$('input[name="sort_ord"]:checked').val(),c=$('input[name="list_col[]"]:checked').map(function(){return this.value}).get();rcmail.set_list_options(c,a,b,rcmail.env.threading)}function L(a){var b,c,d=rcmail.env.task,e=rcmail.env.search_mods,f=rcmail.env.mailbox;e||(e={}),"mail"==d?(e[f]||(e[f]=rcube_clone_object(e["*"])),c=e[f],b="text"):(c=e,b="*"),a.checked?c[a.value]=1:delete c[a.value],a.value==b&&$('input:checkbox[name="s_mods[]"]').map(function(){this!=a&&(this.checked=!0,a.checked?(this.disabled=!0,delete c[this.value]):(this.disabled=!1,c[this.value]=1))})}function M(a){var b=$("#contacts-table"),c=b.parent().css("overflow","hidden");b.clone().css({position:"absolute",top:"0",left:"0",width:b.width()+"px","z-index":10}).appendTo(c).animate({left:-(b.width()+5)+"px"},300,"swing",function(){$(this).remove(),c.css("overflow","auto")})}function N(a){var b=$("#contacts-table"),c=b.parent().css("overflow","hidden"),d=b.clone().appendTo(c);b.css({position:"absolute",top:"0",left:-(b.width()+5)+"px",width:b.width()+"px",height:b.height()+"px","z-index":10}).animate({left:"0"},300,"linear",function(){d.remove(),$(this).css({position:"relative",left:"0",width:"100%",height:"auto","z-index":1}),c.css("overflow","auto")})}function O(){var a=$("#upload-dialog");return a.is(":visible")?void a.dialog("close"):("compose"!=rcmail.env.action||a.data("extended")||($("<a>").addClass("iconlink add").attr("href","#add").html("Add").appendTo($('input[type="file"]',a).parent()).click(P),a.data("extended",!0)),a.dialog({modal:!0,resizable:!1,closeOnEscape:!0,title:a.attr("title"),close:function(){try{$("#upload-dialog form").get(0).reset()}catch(a){}a.dialog("destroy").hide(),$("div.addline",a).remove()},width:480}).show(),void(document.all||$("input[type=file]",a).first().click()))}function P(a){var b=$(this).parent(),c=b.clone().addClass("addline").insertAfter(b);c.children(".iconlink").click(P),c.children("input").val(""),document.all||$("input[type=file]",c).click()}function Q(a,b){var c=$("#compose-"+a);if(!c.is(":visible"))return f[a]&&!b&&$("#_"+a).val(f[a]),c.show(),$("#"+a+"-link").hide(),u(),!1}function R(a){var b=$("#_"+a);return f[a]=b.val(),b.val(""),$("#compose-"+a).hide(),$("#"+a+"-link").show(),u(),!1}function S(a,b){var c=$(a),d=c.get(0).id,e=c.children("fieldset");if(e.length){d||(d="rcmtabcontainer",c.attr("id",d)),b=b||0,e.each(function(a){a!=b&&$(this).hide()});var f=$("<div>").addClass("tabsbar").prependTo(c);e.each(function(a){var c,e,g=$(this),h=g.children("legend");e=$("<a>").text(h.text()).attr("href","#"),c=$("<span>").attr({id:"tab"+a,class:"tablink"}).click(function(){return T(d,a),!1}),h.remove(),g.addClass("tab"),a==b&&c.addClass("selected"),c.append(e).appendTo(f)})}}function T(a,b){var c=$("#"+a).children("fieldset");c.each(function(a){$(this)[b==a?"show":"hide"](),$("#tab"+a).toggleClass("selected",a==b)}),o()}function U(b){var c=$("<iframe>").attr("id","aboutframe").attr("src",rcmail.url("settings/about")).attr("frameborder","0").appendTo(document.body),d=Math.floor(.75*$(window).height()),e={},f=$("#supportlink");f.length&&(a.supporturl=f.attr("href"))&&(e[f.html()]=function(b){a.supporturl.indexOf("mailto:")<0?window.open(a.supporturl):location.href=a.supporturl}),c.dialog({modal:!0,resizable:!1,closeOnEscape:!0,title:b?b.title||b.innerHTML:null,close:function(){c.dialog("destroy").remove()},buttons:e,width:640,height:d}).width(640)}var e,g,a={},b={},c={forwardmenu:{editable:1},searchmenu:{editable:1,callback:G},attachmentmenu:{},listoptions:{editable:1},dragmenu:{sticky:1},groupmenu:{above:1},mailboxmenu:{above:1},spellmenu:{callback:I},"attachment-form":{editable:1,above:1,toggle:!bw.ie&&!bw.linux},"upload-form":{editable:1,toggle:!bw.ie&&!bw.linux}},d=this,f={};if(this.set=j,this.init=m,this.init_tabs=S,this.show_about=U,this.show_popup=y,this.add_popup=x,this.set_searchmod=L,this.show_uploadform=O,this.show_header_row=Q,this.hide_header_row=R,this.update_quota=v,this.get_pref=k,this.save_pref=l,window.$&&document.body){var h=k("minimalmode");(parseInt(h)||null===h&&$(window).height()<850)&&$(document.body).addClass("minimal"),bw.tablet&&$("#viewport").attr("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0")}}function rcube_scroller(a,b,c){var d=this;this.list=$(a),this.top=$(b),this.bottom=$(c),this.step_size=6,this.step_time=20,this.delay=500,this.top.mouseenter(function(){rcmail.drag_active&&(d.ts=window.setTimeout(function(){d.scroll("down")},d.delay))}).mouseout(function(){d.ts&&window.clearTimeout(d.ts)}),this.bottom.mouseenter(function(){rcmail.drag_active&&(d.ts=window.setTimeout(function(){d.scroll("up")},d.delay))}).mouseout(function(){d.ts&&window.clearTimeout(d.ts)}),this.scroll=function(a){var b=this,c=this.step_size;rcmail.drag_active&&("down"==a&&(c*=-1),this.list.get(0).scrollTop+=c,this.ts=window.setTimeout(function(){b.scroll(a)},this.step_time))}}function rcube_splitter(a){function c(a){(bw.konq||bw.chrome||bw.safari)&&(document.body.style.webkitUserSelect="none"),b.p1pos=b.relative?b.p1.position():b.p1.offset(),b.p2pos=b.relative?b.p2.position():b.p2.offset(),b.drag_active=!0,$(document).bind("mousemove."+this.id,d).bind("mouseup."+this.id,f),$("iframe").each(function(a,b){$("<div>").attr("id","iframe-splitter-fix-"+a).addClass("iframe-splitter-fix").css({background:"#fff",width:b.offsetWidth+"px",height:b.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css($(this).offset()).appendTo("body")})}function d(a){return!!b.drag_active&&(window.clearTimeout(b.ts),b.ts=window.setTimeout(function(){e(a)},1),!1)}function e(a){var c=rcube_event.get_mouse_pos(a);if(b.relative){var d=b.p1.parent().offset();c.x-=d.left,c.y-=d.top}b.horizontal?c.y-b.halfsize>b.p1pos.top&&c.y+b.halfsize<b.p2pos.top+b.p2.outerHeight()&&(b.pos=Math.max(b.min,c.y-b.offset),b.resize()):c.x-b.halfsize>b.p1pos.left&&c.x+b.halfsize<b.p2pos.left+b.p2.outerWidth()&&(b.pos=Math.max(b.min,c.x-b.offset),b.resize()),b.p1pos=b.relative?b.p1.position():b.p1.offset(),b.p2pos=b.relative?b.p2.position():b.p2.offset()}function f(a){return(bw.konq||bw.chrome||bw.safari)&&(document.body.style.webkitUserSelect="auto"),$(document).unbind("."+b.id),b.drag_active=!1,$("div.iframe-splitter-fix").remove(),b.set_cookie(),"function"==typeof b.callback&&b.callback(b),!!bw.safari||rcube_event.cancel(a)}function g(a){if(b.horizontal){var c=parseInt(b.p2.parent().outerHeight(),10)-parseInt(b.p2[0].style.top,10)-(bw.ie8?2:0);b.p2.css("height",(c>0?c:0)+"px")}else{var d=parseInt(b.p2.parent().outerWidth(),10)-parseInt(b.p2[0].style.left,10);b.p2.css("width",(d>0?d:0)+"px")}}this.p=a,this.id=a.id,this.horizontal="horizontal"==a.orientation||"h"==a.orientation,this.halfsize=(void 0!==a.size?a.size:10)/2,this.pos=a.start||0,this.min=a.min||20,this.offset=a.offset||0,this.relative=!!a.relative,this.drag_active=!1,this.render=a.render,this.callback=a.callback;var b=this;rcube_splitter._instances[this.id]=b,this.init=function(){if(this.p1=$(this.p.p1),this.p2=$(this.p.p2),this.p1.length&&this.p2.length){if(this.p1pos=this.relative?this.p1.position():this.p1.offset(),this.p2pos=this.relative?this.p2.position():this.p2.offset(),this.handle=$("<div>").attr("id",this.id).attr("unselectable","on").addClass("splitter "+(this.horizontal?"splitter-h":"splitter-v")).appendTo(this.p1.parent()).bind("mousedown",c),this.horizontal){var a=this.p1pos.top+this.p1.outerHeight();this.handle.css({left:"0px",top:a+"px"})}else{var b=this.p1pos.left+this.p1.outerWidth();this.handle.css({left:b+"px",top:"0px"})}bw.ie&&$(window).resize(g);var d=this.get_cookie();d&&!isNaN(d)?(this.pos=parseFloat(d),this.resize()):this.pos&&(this.resize(),this.set_cookie())}},this.resize=function(){if(this.horizontal){if(this.p1.css("height",Math.floor(this.pos-this.p1pos.top-this.halfsize)+"px"),this.p2.css("top",Math.ceil(this.pos+this.halfsize+2)+"px"),this.handle.css("top",Math.round(this.pos-this.halfsize+this.offset)+"px"),bw.ie){var a=parseInt(this.p2.parent().outerHeight(),10)-parseInt(this.p2.css("top"),10)-(bw.ie8?2:0);this.p2.css("height",(a>0?a:0)+"px")}}else if(this.p1.css("width",Math.floor(this.pos-this.p1pos.left-this.halfsize)+"px"),this.p2.css("left",Math.ceil(this.pos+this.halfsize)+"px"),this.handle.css("left",Math.round(this.pos-this.halfsize+this.offset+3)+"px"),bw.ie){var b=parseInt(this.p2.parent().outerWidth(),10)-parseInt(this.p2.css("left"),10);this.p2.css("width",(b>0?b:0)+"px")}this.p2.resize(),this.p1.resize(),this.drag_active&&$("iframe").each(function(a,b){var c=$(this).offset();$("#iframe-splitter-fix-"+a).css({top:c.top+"px",left:c.left+"px",width:b.offsetWidth+"px",height:b.offsetHeight+"px"})}),"function"==typeof this.render&&this.render(this)},this.get_cookie=function(){return window.UI?UI.get_pref(this.id):null},this.set_cookie=function(){window.UI&&UI.save_pref(this.id,this.pos)}}rcube_splitter._instances={},rcube_splitter.get_instance=function(a){return rcube_splitter._instances[a]};